(()=>{"use strict";class t{constructor(){this.actions=[],this.action_counter=0}checkArray(t){return!!Array.isArray(t)||(console.error("Ошибка: переданный параметр 'обьект' не является массивом."),!1)}addAction(t,e=this.actions){if(!this.checkArray(e))return;const s={id:"action_"+ ++this.action_counter,func:t,funcClone:t};e.push(s)}removeAction(t,e=this.actions){if(!this.checkArray(e))return;const s=e.find((e=>e.id==t));s&&(s.func=()=>{})}backAction(t,e=this.actions){if(!this.checkArray(e))return;const s=e.find((e=>e.id==t));s&&(s.func=s.funcClone)}showAction(t=this.actions){this.checkArray(t)&&t.forEach((t=>{console.log("id: "+t.id),console.log("active-func",t.func),console.log("clone",t.funcClone)}))}}class e extends t{constructor(t,e=document){super(),this.event_name=t,this.target_elem=e,this.notDebunceAction=[],this.debunceTimeout=null,this.debunceDelay=100,this.debunceEvents=["resize","scroll","mousemove","touchmove"],this.#t()}addNotDebunceAction(t){this.addAction(t,this.notDebunceAction)}removeNotDebunceAction(t){this.removeAction(t,this.notDebunceAction)}backNotDebunceAction(t){this.backAction(t,this.notDebunceAction)}showNotDebunceAction(){this.showAction(this.notDebunceAction)}#e(t){this.notDebunceAction.length>0&&this.notDebunceAction.forEach((e=>e.func(t))),clearTimeout(this.debunceTimeout),this.debunceTimeout=setTimeout((()=>{this.actions.forEach((e=>e.func(t)))}),this.debunceDelay)}#t(){this.target_elem.addEventListener(this.event_name,(t=>{this.debunceEvents.includes(this.event_name)?this.#e(t):this.actions.forEach((e=>e.func(t)))}))}}class s{constructor(t="--progress-click-time",e="progress-click"){this.sub_class=e,this.style_var=t,this.current_style=null,this.animation_run=null}calcNewTime(t,e,s){let i=Math.abs(s-e);return i=i*t/100,i}changeStyleVar(t,e){const s=`${e}s`;t.classList.add(this.sub_class),t.style.setProperty(this.style_var,s)}backStyleVar(t,e){t.style.setProperty(this.style_var,e),t.classList.remove(this.sub_class)}init(t,e,s){const i=s.style.getPropertyValue(this.style_var);if(i){s.classList.contains(this.sub_class)?(clearTimeout(this.animation_run),this.backStyleVar(s,this.current_style)):this.current_style=i;const o=parseFloat(this.current_style);if(Number.isNaN(o))return;const n=this.calcNewTime(o,t,e);this.changeStyleVar(s,n),this.animation_run=setTimeout((()=>{this.backStyleVar(s,this.current_style),this.current_style=null,this.animation_run=null}),1e3*n)}}handleInput(t,e){let s=null;m.addAction((t=>{t.target==e&&(s=e.value)})),g.addAction((t=>{t.target==e&&(s=null)})),u.addAction((i=>{if(i.target==e&&null!=s){const i=e.value;i!=s&&(Math.abs(i-s)>1&&this.init(s,i,t),s=i)}}))}}class i{constructor(t,e){this.action=e,this.options={root:null,threshold:t},this.callback=this.callback.bind(this),this.observer=new IntersectionObserver(this.callback,this.options)}callback(t){t.length>0&&t.forEach((t=>{this.action(t)}))}observe(t){t&&this.observer.observe(t)}unobserve(t){t&&this.observer.unobserve(t)}disconnect(){this.observer.disconnect()}}class o{constructor({boardSelector:t,delayAttrSelector:e="[data-delay]",delayDataName:s="delay",threshold:o=.1}){this.boardAtr=t,this.delayAtr=e,this.delayDataName=s,this._entryCounter=0,this.boardList=document.querySelectorAll(this.boardAtr),this._intFunc=this._intFunc.bind(this),this._observer=new i(o,this._intFunc),this.boardList.length>0&&this.boardList.forEach((t=>{this.observeCards(t)}))}_getDelay(t){if(t.closest(this.delayAtr)){const e=t.closest(this.delayAtr).dataset[this.delayDataName];return e&&!isNaN(e)?1e3*e:0}return 0}observeCards(t){const e=[...t.children];e.length>0&&e.forEach((t=>{this._observer.observe(t)}))}addCard(t){this._observer.observe(t)}_intFunc(t){if(t.isIntersecting){this._entryCounter=++this._entryCounter;const e=this._getDelay(t.target),s=e+e*this._entryCounter;this._itemAction(t.target,s)}else this._entryCounter>0&&(this._entryCounter=--this._entryCounter)}_itemAction(t,e){}}class n extends o{constructor({boardSelector:t="[data-step-animate]",delayAttrSelector:e="[data-delay]",delayDataName:s="delay",threshold:i=.1}={}){super({boardSelector:t,delayAttrSelector:e,delayDataName:s,threshold:i})}_itemAction(t,e){setTimeout((()=>{t.classList.add("step-animate"),this._observer.unobserve(t)}),e)}}class l extends o{constructor({boardSelector:t="[data-lazy-board]",delayAttrSelector:e="[data-delay]",delayDataName:s="delay",threshold:i=.1}={}){super({boardSelector:t,delayAttrSelector:e,delayDataName:s,threshold:i})}_checkLazyImage(t){const e=t.querySelector("[data-src]");if(e)return e}_itemAction(t,e){const s=this._checkLazyImage(t);if(!s)return void this._observer.unobserve(t);let i=new Image;s.src=s.dataset.src,i.src=s.dataset.src;const o=()=>{setTimeout((()=>{t.classList.add("card-loaded"),this._observer.unobserve(t)}),e)};i.onload=o,i.onerror=o}}const a=document.body,r=document.querySelector(".header"),h=new e("scroll",window),c=new e("click"),d=new e("resize",window),u=new e("input"),m=new e("pointerover"),g=new e("pointerout"),y=new class{constructor(t,e){this.elem=t,this.styleVar=e}init(){this.getHeigth(),this.value&&this.value!==this.oldValue&&(this.oldValue=this.value,this.setHeight())}getHeigth(){this.elem&&(this.value=this.elem.offsetHeight)}setHeight(){this.styleVar&&this.value&&a.style.setProperty(`${this.styleVar}`,`${this.value}px`)}initOnTransition(){const t=this.elem.querySelector("[data-transition-event]");if(t){if(!t.dataset.transitionEvent)return;this.elem.addEventListener("transitionend",(t=>{"padding-top"==t.propertyName&&y.init()}))}}}(r,"--header-size"),b=new class{constructor(){this.events=["mousedown","mousemove","mouseup","touchstart","touchmove","touchend"],this.moveDelay=0,this.swipe_zone_selector="[data-swipe]",this.event_block_selector="[data-event-block]",this.active_swipe_zone=null,this.blocked_zone=null,this.listeners=this.#s(this.events),this.#i(),this.#o(),this.#n()}#i(){this.x=null,this.y=null,this.xDef=0,this.yDef=0}#n(){this.startActionList=[],this.moveActionList=[],this.endActionList=[]}#s(t){return t.map((t=>new e(t)))}#l(t){this.blocked_zone&&this.blocked_zone.classList.contains("events-removed")&&(this.blocked_zone.classList.remove("events-removed"),this.blocked_zone.style.pointerEvents="",this.blocked_zone.style.userSelect="",this.blocked_zone=null)}#a(t){null!==this.x&&null!==this.y&&!this.blocked_zone&&t.target.closest(this.event_block_selector)&&(this.blocked_zone=t.target.closest(this.event_block_selector),this.blocked_zone.classList.contains("events-removed")||(this.blocked_zone.classList.add("events-removed"),this.blocked_zone.style.pointerEvents="none",this.blocked_zone.style.userSelect="none"))}startSwipe(t){if(null===this.x&&null===this.y&&t.target.closest(this.swipe_zone_selector)){this.active_swipe_zone=t.target.closest(this.swipe_zone_selector);const{x:e,y:s}=this.#r(t);if(this.x=e,this.y=s,this.startActionList.length>0){const t=this.active_swipe_zone;this.startActionList.forEach((e=>e(t)))}}}moveSwipe(t){if(null!==this.x&&null!==this.y){const{x:e,y:s}=this.#r(t);this.xDef=e-this.x,this.yDef=s-this.y;const i={x:this.x,y:this.y,xDef:this.xDef,yDef:this.yDef};if(this.moveActionList.length>0){const e=[i,t];this.moveActionList.forEach((t=>t(...e)))}}}endSwipe(t){if(null!==this.x&&null!==this.y){if(this.#l(t),this.endActionList.length>0){const e=t;this.endActionList.forEach((t=>t(e)))}this.active_swipe_zone=null,this.#i()}}#o(){this.listeners.forEach((t=>{switch(t.event_name){case"mousedown":case"touchstart":t.addAction((t=>this.startSwipe(t)));break;case"mousemove":case"touchmove":t.debunceDelay=this.moveDelay,t.addNotDebunceAction((t=>this.#a(t))),t.addAction((t=>this.moveSwipe(t)));break;case"mouseup":case"touchend":t.addAction((t=>this.endSwipe(t)));break;default:console.log("Ошибка: Неизвестное событие")}}))}#r(t){let e=null,s=null;return"mousedown"===t.type||"mousemove"===t.type||"mouseup"===t.type?(e=t.clientX,s=t.clientY):"touchstart"!==t.type&&"touchmove"!==t.type&&"touchend"!==t.type||t.touches&&t.touches[0]&&(e=t.touches[0].clientX,s=t.touches[0].clientY),{x:e,y:s}}setOnSwipeStart(t){this.startActionList.push(t)}setOnSwipeMove(t){this.moveActionList.push(t)}setOnSwipeEnd(t){this.endActionList.push(t)}},v=new class{constructor(){this.bodyClasses=a.classList,this.lockSpace=window.innerWidth-a.offsetWidth,this.delay=0,this.holdElems=[...document.querySelectorAll("[data-hold-on-lost-scroll]")],this.holdElemsPadding=this.#h("padding"),this.holdElemsLeft=this.#h("left"),this.holdElemsRight=this.#h("right"),this.lastLockSpace=this.lockSpace,this.holdPositionOnResize()}#c(){return window.innerWidth-a.offsetWidth!==this.lastLockSpace&&(this.lastLockSpace=window.innerWidth-a.offsetWidth,this.lockSpace=this.lastLockSpace,!0)}getDataList(t){return t.dataset.holdOnLostScroll.split(",")}#h(t){return this.holdElems.filter((e=>this.getDataList(e)[0]===t))}#d(t,e){const s=this.getDataList(t);let i;return!(s.length>=2)||(i=+s[1],!isNaN(i)&&(window.innerWidth<i||""==e))}holdPositionOnResize(){d.addAction((()=>{this.bodyClasses.contains("lock")&&(this.#u(this.lockSpace),this.#c()&&this.addBlock())}))}#u(t){const e=(e,s)=>{e.length>0&&("left"===s||"right"===s)&&e.forEach((e=>{if(this.#d(e,t)){let i;if("number"==typeof t){e.style[s]="";let o=window.getComputedStyle(e)[s];o=parseFloat(o),i="left"===s?o:o+t,i+="px"}else i="";e.style[s]=i}}))};e(this.holdElemsLeft,"left"),e(this.holdElemsRight,"right")}#m(t){this.holdElemsPadding.length>0&&this.holdElemsPadding.forEach((e=>{this.#d(e,t)&&(e.style.paddingRight=`${t}`)})),a.style.paddingRight=`${t}`}getBodyStatus(){return this.bodyClasses.contains("lock")?"lock":"unlock"}toggleBlock(){this.bodyClasses.toggle("lock");const t=this.getBodyStatus();setTimeout((()=>{"lock"===t?this.addBlock():this.removeBlock()}),this.delay)}addBlock(){"hidden"!=a.style.overflow&&(a.style.overflow="hidden"),this.#u(this.lockSpace),this.#m(`${this.lockSpace}px`)}removeBlock(){a.style.overflow="",this.#m(""),this.#u("")}},_=new class{constructor(){this.lastScroll=window.scrollY}getScrollDirection(){const t=window.scrollY-this.lastScroll;return this.lastScroll=window.scrollY,t>0?"down":t<0?"up":"none"}};new class{constructor({delay:t=50,afterfunc:e=()=>{}}={}){this.body=a,this.afterfunc=e,this.delay=t,this.currentDelay=0,this.loadCounter=0,this.preloader=document.querySelector("[data-preloader]"),this.createImageList(),this.init()}init(){this.imageQuantity>0&&this.imageList.forEach((t=>{this.currentDelay+=this.delay,this.loadImage(t,this.currentDelay)}))}loadImage(t,e){const s=()=>{this.loadCounter=++this.loadCounter,this.calcPogress()};let i=new Image;i.src=t.src,i.onload=()=>setTimeout(s,e),i.onerror=()=>setTimeout(s,e)}calcPogress(){if(!this.preloader)return;const t=this.loadCounter/this.imageQuantity*100;this.preloader.style.setProperty("--page-loader",`${t}%`),this.loadCounter==this.imageQuantity&&setTimeout((()=>{this.body.classList.add("doc-loaded"),this.afterfunc()}),this.delay)}createImageList(){this.imageList=[...document.querySelectorAll("img")],this.imageQuantity=this.imageList.length}}({afterfunc:function(){new l,new n}}),new class{constructor(){this.ev_list=["mousedown","mouseup","touchstart","touchend","pointerout"],this.createEventObservers(),this.init()}createEventObservers(){this.ev_list=this.ev_list.map((t=>new e(t)))}init(){this.ev_list.forEach((t=>{switch(t.event_name){case"mousedown":case"touchstart":t.addAction((t=>this.addHover(t)));break;case"mouseup":case"touchend":case"pointerout":t.addAction((t=>this.removeHover(t)));break;default:console.log("Ошибка: Неизвестное событие")}}))}addHover(t){(t.target.closest("button")||t.target.closest("a"))&&(this.target=t.target.closest("button")?t.target.closest("button"):t.target.closest("a"),this.target.classList.add("hover"))}removeHover(){this.target&&(this.target.classList.remove("hover"),this.target=!1)}},new class{constructor(t){this.navbox_selector=t,this.path=document.location.pathname,this.linkList=this.getLinkList(this.navbox_selector),this.highlightActiveLink()}highlightActiveLink(){this.linkList.length>0&&this.linkList.forEach((t=>{this.#g(t)}))}getLinkList(t){const e=document.querySelector(t);let s=[];if(e){const t=e.querySelectorAll("a");t.length>0&&(s=Array.from(t))}return s}#g(t){const e=t.getAttribute("href");(this.path.endsWith(e)||"/"===this.path&&"index.html"===e)&&setTimeout((()=>{t.classList.add("active-link")}),100)}}(".menu__list"),new class{selectors={wrapper:".progress-gallery",slide_body:".progress-gallery__body",slide_before:".progress-gallery__image-before",slide_after:".progress-gallery__image-after",btn_before:".btn-before",btn_after:".btn-after",progress_input:".progress__input"};constructor(){this.gallery_list=document.querySelectorAll(this.selectors.wrapper),this.smoothClick=new s,this.gallery_list.length>0&&this.gallery_list.forEach((t=>{this.handleGallery(t)}))}handleGallery(t){const e=t.querySelector(this.selectors.slide_body);if(e){const s=t.querySelector(this.selectors.progress_input),i={btn_before:t.querySelector(this.selectors.btn_before),btn_after:t.querySelector(this.selectors.btn_after)};this.setImagesWidth(e),s&&(this.onInput(t,s),i.btn_after&&i.btn_before&&this.onBtnClick(t,s),this.addSwipe(t,e,s))}}#y(t,e){let s=e/t*100;return Math.round(s)}#b(t,e){if("number"==typeof t&&"number"==typeof e&&t!==e){let s=null;const i=Math.abs(t-e);return i>40?s=t>e?0:100:i<5?e>5&&e<95&&(s=t):s=e,s}}setImagesWidth(t){this.#v(t),d.addAction(this.#v.bind(this,t))}onInput(t,e){this.#_(t,e,e.value),this.smoothClick.handleInput(t,e),u.addAction((()=>{this.#_(t,e,e.value)}))}addSwipe(t,e,s){let i,o,n=!0,l=null;b.setOnSwipeStart((e=>{l=this.#f(t,e,b.swipe_zone_selector)})),b.setOnSwipeMove(((a,r)=>{if(l){!0===n&&(i=Number(s.value),n=!1);const l=a.xDef,r=e.offsetWidth,h=this.#y(r,l);o=i+h,o=o>=0&&o<=100?o:o<0?0:100,s.value=o,this.#_(t,s,o)}})),b.setOnSwipeEnd((e=>{if(l){const e=this.#b(i,o);void 0!==e&&(s.value=e,this.#_(t,s,e)),n=!0}l=null}))}#f(t,e,s){const i=t.querySelector(s);return!!(i&&i==e||t==e)}onBtnClick(t,e){c.addAction((s=>{if(s.target.closest(this.selectors.btn_before)||s.target.closest(this.selectors.btn_after)){const i=e.value,o=s.target.closest(this.selectors.btn_before),n=s.target.closest(this.selectors.btn_after);let l=null;if(l=o?this.#f(t,o,this.selectors.btn_before):this.#f(t,n,this.selectors.btn_after),l){o&&(e.value=0),n&&(e.value=100);const s=e.value;i!==s&&(this.smoothClick.init(i,s,t),this.#_(t,e,s))}}}))}#v(t){const e=t.querySelectorAll("img"),s=t.offsetWidth;e.length>0&&e.forEach((t=>{t.style.width=`${s}px`}))}#_(t,e,s){window.requestAnimationFrame((()=>{t.style.setProperty("--slide-balance",`${s}%`),e.setAttribute("value",s)}))}},new class{constructor(t=".icon-menu",e=768.5){this.burger_btn=t,this.mobile_width=e,this.animation_time=1e3,this.bodyClasses=a.classList,this.bodyLock=v,c.addAction((t=>{this.#p(t)})),d.addAction((()=>{this.#w(),this.#A()})),h.addAction(this.closeOnScroll.bind(this))}closeOnScroll(){this.bodyClasses.contains("menu-open")&&!this.bodyClasses.contains("lock")&&(this.bodyClasses.remove("menu-open"),this.bodyClasses.add("non-hide"),setTimeout((()=>{this.bodyClasses.remove("non-hide")}),this.animation_time))}#w(){window.innerWidth>=this.mobile_width&&this.bodyClasses.contains("menu-open")&&(this.bodyClasses.remove("menu-open"),this.bodyClasses.contains("lock")&&(this.bodyClasses.remove("lock"),this.bodyLock.removeBlock()))}#A(){window.innerWidth<this.mobile_width&&this.bodyClasses.contains("menu-open")&&(window.innerHeight<this.mobile_width&&!this.bodyClasses.contains("lock")?(this.bodyClasses.add("lock"),this.bodyLock.addBlock()):window.innerHeight>=this.mobile_width&&(this.bodyClasses.remove("lock"),this.bodyLock.removeBlock()))}#p(t){t.target.closest(this.burger_btn)&&(this.bodyClasses.toggle("menu-open"),window.innerHeight<this.mobile_width&&this.bodyLock.toggleBlock())}},new class{constructor(t,e=32){this.header=r,this.firstElem=document.querySelector(t),this.saveHeight=e,this.header&&(this.headerClasses=this.header.classList,this.dirScroll=_.getScrollDirection.bind(_),this.iteration())}iteration(){y.init(),this.addHeaderClasses(),h.addNotDebunceAction((t=>{window.requestAnimationFrame((()=>{this.checkScroll(t)}))})),y.initOnTransition(),d.addAction((()=>{y.init()}))}checkScroll=t=>{const e=this.dirScroll();this.addHeaderClasses(e,t)};#k(t){this.firstElem&&(this.firstElemHeight=this.firstElem.offsetHeight,t<=this.firstElemHeight-y.value?this.headerClasses.add("header-first-page-view"):t>this.firstElemHeight-y.value&&this.headerClasses.remove("header-first-page-view"))}#S(t,e){"down"===e?(this.firstElem&&t>=this.firstElemHeight+this.saveHeight||!this.firstElem&&t>this.saveHeight)&&(this.header.closest(".menu-open")&&this.header.closest(".lock")||this.header.closest(".non-hide")||this.headerClasses.add("header-hide")):"up"===e&&this.headerClasses.remove("header-hide")}#L(t){t<=this.saveHeight+y.value?this.headerClasses.add("header-top"):this.headerClasses.remove("header-top")}addHeaderClasses(t,e){this.scrollY=window.scrollY,this.#k(this.scrollY),this.#L(this.scrollY),this.#S(this.scrollY,t)}}(".titlepage"),new class{constructor(){this.elem__list=[...document.querySelectorAll("[data-resize-load]")],this.createObjList(),this.init(),d.addAction(this.init.bind(this))}init(){const t=window.innerWidth;this.elem__list.length>0&&this.elem__list.forEach((e=>{let s=!1;!e.maxWidth&&t>=e.minWidth&&(s=!0),e.maxWidth&&(e.minWidth>e.maxWidth?(t>=e.minWidth||t<=e.maxWidth)&&(s=!0):t>=e.minWidth&&t<=e.maxWidth&&(s=!0)),s&&this.replaceAddress(e)})),this.elem__list=this.elem__list.filter((t=>"loaded"!==t.path))}replaceAddress(t){"loaded"!==t.path&&(t.elem.setAttribute("src",t.path),t.elem.classList.add("picture-loaded"),t.path="loaded")}createObjList(){this.elem__list.length>0&&(this.elem__list=this.elem__list.map((t=>{let e=null,s=!0;const i=t.dataset.resizeLoad,o=t.dataset.src;if(i&&o){let[n,l]=i.split(",");return(isNaN(n)||l&&isNaN(l))&&(console.warn(t,"неверное значение у атрибута data-resize-load , он принимает только числовые значения"),s=!1),s&&(e={elem:t,path:o,minWidth:n,maxWidth:l}),e}return console.warn(t,"не заполнен атрибут resize-load или data-src"),null})).filter(Boolean))}},window.FLS=!0,function(t){let e=new Image;e.onload=e.onerror=function(){t(2==e.height)},e.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}((function(t){let e=!0===t?"webp":"no-webp";document.documentElement.classList.add(e)}))})();